/*! angular-base64-upload - v0.1.17
* https://github.com/adonespitogo/angular-base64-upload
* Copyright (c) Adones Pitogo <pitogo.adones@gmail.com> [June 05, 2016]
* Licensed MIT */

!function(a,b){"use strict";a._arrayBufferToBase64=function(b){for(var c="",d=new Uint8Array(b),e=d.byteLength,f=0;e>f;f++)c+=String.fromCharCode(d[f]);return a.btoa(c)};var c=a.angular.module("naif.base64",[]);c.directive("baseSixtyFourInput",["$window","$q",function(a,b){for(var c={onChange:"&",onAfterValidate:"&",parser:"&"},d=["onabort","onerror","onloadstart","onloadend","onprogress","onload"],e=d.length-1;e>=0;e--){var f=d[e];c[f]="&"}return{restrict:"A",require:"ngModel",scope:c,link:function(c,e,f,g){function h(){for(var c=u.length-1;c>=0;c--){var d=new a.FileReader,e=u[c],f={};f.filetype=e.type,f.filename=e.name,f.filesize=e.size,u[c].deferredObj=b.defer(),k(d,e,f),d.readAsArrayBuffer(e)}}function i(a){f.onChange&&c.onChange()(a,u)}function j(a){if(f.onAfterValidate){for(var d=[],e=u.length-1;e>=0;e--)d.push(u[e].deferredObj.promise);b.all(d).then(function(){c.onAfterValidate()(a,v,u)})}}function k(a,b,e){for(var g=d.length-1;g>=0;g--){var h=d[g];f[h]&&"onload"!==h&&l(h,c[h],a,b,e)}a.onload=m(a,b,e)}function l(a,b,c,d,e){c[a]=function(a){b()(a,c,d,u,v,e)}}function m(d,e,g){return function(h){var i,j=h.target.result;g.base64=a._arrayBufferToBase64(j),i=f.parser?b.when(c.parser()(e,g)):b.when(g),i.then(function(a){v.push(a),n(),e.deferredObj.resolve()}),f.onload&&c.onload()(h,d,e,u,v,g)}}function n(){var a=f.multiple?v:v[0];g.$setViewValue(a),q(a),r(a),o(a),p(a),t(a),s(a)}function o(a){if(f.maxnum&&f.multiple&&a){var b=a.length<=parseInt(f.maxnum);g.$setValidity("maxnum",b)}return a}function p(a){if(f.minnum&&f.multiple&&a){var b=a.length>=parseInt(f.minnum);g.$setValidity("minnum",b)}return a}function q(a){var b=!0;if(f.maxsize&&a){var c=1e3*parseFloat(f.maxsize);if(f.multiple)for(var d=0;d<a.length;d++){var e=a[d];if(e.filesize>c){b=!1;break}}else b=a.filesize<=c;g.$setValidity("maxsize",b)}return a}function r(a){var b=!0,c=1e3*parseFloat(f.minsize);if(f.minsize&&a){if(f.multiple)for(var d=0;d<a.length;d++){var e=a[d];if(e.filesize<c){b=!1;break}}else b=a.filesize>=c;g.$setValidity("minsize",b)}return a}function s(a){var b,c,d,e=!0;if(f.accept&&(c=f.accept.trim().replace(/[,\s]+/gi,"|").replace(/\./g,"\\.").replace(/\/\*/g,"/.*"),b=new RegExp(c)),f.accept&&a){if(f.multiple)for(var h=0;h<a.length;h++){var i=a[h];if(d="."+i.filename.split(".").pop(),e=b.test(i.filetype)||b.test(d),!e)break}else d="."+a.filename.split(".").pop(),e=b.test(a.filetype)||b.test(d);g.$setValidity("accept",e)}return a}function t(a){var b=!0;if(f.maxdim&&a){var c=f.maxdim,d=c.width,e=c.height,h=new Image;if(f.multiple)for(var i=0;i<a.length;i++){var j=a[i];if(h.src="data:"+j.filetype+";base64,"+j.base64,d&&h.width>d){b=!1;break}if(e&&h.height>d){b=!1;break}}else h.src="data:"+a.filetype+";base64,"+a.base64,d&&h.width>d&&(b=!1),e&&h.height>e&&(b=!1);g.$setValidity("maxdim",b)}return a}if(g){var u=[],v=[];e.on("change",function(a){a.target.files.length&&(v=[],v=angular.copy(v),u=a.target.files,h(),i(a),j(a))}),g.$isEmpty=function(a){return!a||(angular.isArray(a)?0===a.length:!a.base64)},c._clearInput=function(){e[0].value=""},c.$watch(function(){return g.$viewValue},function(a,b){g.$isEmpty(b)||g.$isEmpty(a)&&c._clearInput()})}}}}])}(window);
//# sourceMappingURL=angular-base64-upload.min.js.map